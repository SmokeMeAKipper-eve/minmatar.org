---
import { countdown } from '@helpers/countdown';

interface Props {
    id:             number;
    tag?:           string;
    date:           Date;
    expired_text?:  string;
    [propName: string]: any;
}

const {
    id,
    tag = 'countdown',
    date,
    expired_text,
} = Astro.props;

const timestamp = new Date().getTime()

const {
    text,
    expired,
} = countdown(date, expired_text)
---

<p class:list={[ 'countdown', { expired: expired, 'expired-text': expired && expired_text } ]} id={`${tag}-${id}-${timestamp}`}>{text}</p>

<script define:vars={{ id, tag, date, expired_text, timestamp }}>
    countdown(`#${tag}-${id}-${timestamp}`, id, date, expired_text);
</script>

<style lang="scss">
	p {
        font-family: var(--countdown-font);
		font-size: var(--step-2);
		letter-spacing: 12px;
        text-indent: 12px;
		line-height: 1;
        white-space: nowrap;
        text-transform: uppercase;
	}

    .expired:not(.expired-text) {
        color: var(--fleet-red);
    }

    .expired-text {
        font-family: var(--heading-font) !important;
        font-size: var(--step-0);
        color: var(--highlight);
    }
</style>